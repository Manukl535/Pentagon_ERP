<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>Product Page with Virtual Assistant</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>

    .popup-widget {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 10px;
        }

        #webchat {
            height: 300px;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        #closeChatButton {
            background-color: #dc3545;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .message-icon {
            color: #dc3545;
            position: fixed;
            padding-left: 1300px;
            bottom: 20px;
            left: 20px;
            cursor: pointer;
            z-index: 1000;
        }

        .message-icon img {
            width: 40px;
            height: 40px;
        }
    </style>
</head>
<body>
    <div id="webchatPopup" class="popup-widget">
        <div id="webchat" role="main"></div>
        <button id="closeChatButton">Close</button>
    </div>

    <div class="message-icon" id="openChatButton">
        <i class="material-icons">&#xe0c9;</i>
    </div>

    <script>
        const directLineToken = 'YOUR_DIRECT_LINE_SECRET_HERE'; 

        const openChatButton = document.getElementById('openChatButton');
        const closeChatButton = document.getElementById('closeChatButton');
        const webchatPopup = document.getElementById('webchatPopup');

        openChatButton.addEventListener('click', () => {
            webchatPopup.style.display = 'block';
            openChatButton.style.display = 'none';
        });

        closeChatButton.addEventListener('click', () => {
            webchatPopup.style.display = 'none';
            openChatButton.style.display = 'block';
        });

        (async function () {
            const store = window.WebChat.createStore({}, ({ dispatch }) => next => action => {
                if (action.type === 'DIRECT_LINE/POST_ACTIVITY') {
                    const { activity } = action.payload;
                    if (activity.type === 'message') {
                        
                    }
                }
                return next(action);
            });

            window.WebChat.renderWebChat({
                directLine: window.WebChat.createDirectLine({ token: directLineToken }),
                store
            }, document.getElementById('webchat'));
        })().catch(err => console.error(err));
    </script>
</body>
</html>